---
paths:
  - "messages/**"
  - "app/[locale]/**"
  - "app/(app)/**"
  - "app/(auth)/**"
  - "i18n/**"
  - "proxy.ts"
---

# Internationalization Rules (next-intl)

## Hybrid Routing Strategy

Marketing routes and app routes handle locale differently:

| Route group | Locale in URL | Example URLs | Why |
|-------------|---------------|--------------|-----|
| `(marketing)` | `as-needed` prefix | `/` (en), `/es` (es), `/pricing` (en), `/es/pricing` (es) | SEO: hreflang tags, Google indexes both languages |
| `(app)` | No prefix | `/gear`, `/roll/abc123`, `/settings` | Clean URLs, locale from cookie |
| `(auth)` | No prefix | `/login` | Clean URLs, locale from cookie |

### How it works
- Marketing pages live in `app/[locale]/(marketing)/` — the `[locale]` segment provides locale-prefixed URLs for non-default locales.
- App pages live in `app/(app)/` — no `[locale]` segment. Middleware sets the locale from the `NEXT_LOCALE` cookie or `Accept-Language` header.
- Middleware handles the split: routes starting with `/es/` (or other non-default locales) that match marketing paths get the locale prefix; all other routes pass through without prefix.
- `<link rel="alternate" hreflang="...">` tags added to marketing pages only.

## Setup

- Locales: `en` (default), `es`
- Messages: `messages/en.json`, `messages/es.json`
- Root layout sets `<html lang={locale}>` dynamically (resolved from cookie/header for app routes)
- Language switcher in settings sets `NEXT_LOCALE` cookie and reloads

## String Rules

- All user-facing text uses `useTranslations()` (client) or `getTranslations()` (server).
- Zero hardcoded English strings in components. This includes: labels, placeholders, error messages, button text, empty states, tooltips.
- Namespace by feature: `{ "gear": { "addCamera": "Add Camera" }, "roll": { "loadNew": "..." } }`
- Use ICU message syntax for plurals: `{count, plural, one {# frame} other {# frames}}`

## When Adding New UI Text

1. Add the key to `messages/en.json` first
2. Add the Spanish translation to `messages/es.json`
3. Use `t('namespace.key')` in the component
4. Never use template literals with mixed translated/untranslated text
